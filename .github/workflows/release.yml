name: Release

on:
  release:
    types: [created]

permissions:
  contents: read

jobs:
  run:
    uses: bitcart/bitcart-actions/.github/workflows/build-docker-image.yml@master
    permissions:
      contents: read
      packages: write
      id-token: write
      attestations: write
      artifact-metadata: write
    with:
      dockerfile: Dockerfile
      image-name: ${{ vars.DOCKERHUB_USER }}/bitcart-admin
      tags: |
        type=raw,value=${{ github.event.release.tag_name }}
        type=raw,value=stable
      dockerhub-user: ${{ vars.DOCKERHUB_USER }}
    secrets:
      dockerhub-token: ${{ secrets.DOCKERHUB_TOKEN }}
